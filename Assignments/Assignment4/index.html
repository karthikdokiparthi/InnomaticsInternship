<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://kit.fontawesome.com/acf205ba5f.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <nav>
        <div class="logo">
            <h1>ShopEase</h1>
        </div>
        <div class="navbar">
            <ul>
                <li onclick="fetchData()">Home</li>
                <li onclick="dataCloths()">Cloths</li>
                <li onclick="dataElectronics()">Mobiles</li>
                <li onclick="dataFootwear()">Footwear</li>
            </ul>
        </div>
        <div class="cart">
            <img
                src="https://static.vecteezy.com/system/resources/previews/015/131/853/original/flat-shopping-cart-cartoon-wallpaper-modern-flat-design-for-shopping-online-website-layout-design-png.png">
            <span id="cart-count">0</span>
        </div>
    </nav>
    <section>
        <div id="menu-grid">

        </div>
    </section>
    <section>
        <div id="cart-container">
            <h2>Order Display</h2>
            <ul id="orderdisplay">
                <li>Your order is Empty</li>
            </ul>
            <h3>Total: Rs. <span id="totalPrice">0.00</span></h3>
        </div>
    </section>

    <script>
        let menuData = [];
        function fetchData() {
            fetch('product.json')
                .then(response => response.json())
                .then(data => {
                    menuData = data;
                    dispalyData();
                });
        }
        function dispalyData() {
            let card = document.getElementById('menu-grid');
            let cardHTML = '';
            menuData.forEach(data => {
                cardHTML +=
                    `<div class="grid-card">
                    <img src=${data.img} alt=${data.title}/>
                    <h3>${data.title}</h3>
                    <p class="mark-dash">${data.prevPrice}</p>
                    <p>Rs.${data.newPrice}</p>
                    <button class="btn" onclick="addToCart(${data.id})"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
                    </div>`;
            })
            card.innerHTML = cardHTML;
        }

        function dataElectronics() {
            let card = document.getElementById("menu-grid");
            let cardHTML = "";
            let electronics = menuData.filter(ele => ele.category === "electronics");
            electronics.forEach(data => {
                cardHTML +=
                    `<div class="grid-card">
                    <img src=${data.img} alt=${data.title}/>
                    <h3>${data.title}</h3>
                    <p class="mark-dash">${data.prevPrice}</p>
                    <p>Rs.${data.newPrice}</p>
                    <button class="btn" onclick="addToCart(${data.id})"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
                    </div>`;
            })
            card.innerHTML = cardHTML;
        }
        function dataCloths() {
            let card = document.getElementById("menu-grid");
            let cardHTML = "";
            let cloths = menuData.filter(cls => cls.category === "cloths");
            cloths.forEach(data => {
                cardHTML +=
                    `<div class="grid-card">
                    <img src=${data.img} alt=${data.title}/>
                    <h3>${data.title}</h3>
                    <p class="mark-dash">${data.prevPrice}</p>
                    <p>Rs.${data.newPrice}</p>
                    <button class="btn" onclick="addToCart(${data.id})"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
                    </div>`;
            })
            card.innerHTML = cardHTML;
        }

        function dataFootwear() {
            let card = document.getElementById("menu-grid");
            let cardHTML = "";
            let footwear = menuData.filter(foot => foot.category === "footwear");
            footwear.forEach(data => {
                cardHTML += `
                    <div class="grid-card">
                    <img src=${data.img} alt=${data.title}/>
                    <h3>${data.title}</h3>
                    <p class="mark-dash">${data.prevPrice}</p>
                    <p>Rs.${data.newPrice}</p>
                    <button class="btn" onclick="addToCart(${data.id})"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
                    </div>`;
            })
            card.innerHTML = cardHTML;
        }
        function addToCart(id) {
            const item = menuData.find(f => f.id === id);
            if (item) {
                Order.addItems(item);
            }
        }
        const Order = {
            items: [],
            addItems: function (item) {
                const existingItem = this.items.find(i => i.id === item.id);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    this.items.push({ ...item, quantity: 1 });
                }
                updateOrderDisplay();
            },
            increaseItem: function (id) {
                const item = this.items.find(i => i.id === id);
                if (item) {
                    if (item.quantity < 10) {
                        item.quantity++;
                        updateOrderDisplay();
                    } else {
                        alert("Maximum limit reached!");
                    }
                }
            },
            decreaseItem: function (id) {
                const item = this.items.find(i => i.id === id);
                if (item && item.quantity > 1) {
                    item.quantity--;
                } else {
                    this.items = this.items.filter(i => i.id !== id);
                }
                updateOrderDisplay();
            },
            removeItem: function (id) {
                this.items = this.items.filter(i => i.id !== id);
                updateOrderDisplay();
            },
            calaculateTotal: function () {
                let total = 0;
                this.items.forEach((item) => {
                    total += item.newPrice * item.quantity;
                })
                return total;
            }
        };

        function updateOrderDisplay() {
            const orderDisplay = document.getElementById('orderdisplay');
            if (Order.items.length === 0) {
                orderDisplay.innerHTML = "<li>Your cart is empty</li>";
            } else {
                let orderHTML = "";
                Order.items.forEach(item => {
                    orderHTML += `
                <li>
                    <div class="order-item-info">
                        <img src="${item.img}"/>
                        ${item.title} - ${item.quantity} pcs<br>
                        Rs.${(item.newPrice * item.quantity).toFixed(2)}
                    </div>
                    <div class="order-item-btn">
                        <button class="increase" onclick="Order.increaseItem(${item.id})">+</button>
                        <button class="decrease" onclick="Order.decreaseItem(${item.id})">-</button>
                        <button class="remove" onclick="Order.removeItem(${item.id})"><i class="fa-solid fa-trash-can"></i></button>
                        </div>
                </li>
            `;
                });
                orderDisplay.innerHTML = orderHTML;
            }
            document.getElementById('totalPrice').textContent = Order.calaculateTotal();
            updateCartCount();
        }
        function updateCartCount() {
            const cartCountElement = document.getElementById("cart-count");
            cartCountElement.textContent = Order.items.length;

            // Show badge only if cart has items
            if (Order.items.length > 0) {
                cartCountElement.style.display = "block";
            } else {
                cartCountElement.style.display = "none";
            }
        }
        document.querySelector(".cart img").addEventListener("click", function () {
            document.getElementById("cart-container").classList.toggle("open");
        });

        fetchData();
    </script>
</body>

</html>